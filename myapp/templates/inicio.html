{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No Estás Sola</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <link rel="stylesheet" href="{% static 'css/inicio.css' %}">
    <link rel="icon" href="{% static 'img/logoalcaldia.ico' %}" type="image/x-icon">
</head>

<body>
    <div class="desktop-1">
        <div class="button-group">
            <div class="icon-button-container">
                <div class="icon-container">
                    <img src="{% static 'img/whatsapp.png' %}" alt="Linea púrpura" class="icon" />
                </div>
                <form method="POST" id="form-Linea púrpura" class="form-boton">
                    {% csrf_token %}
                    <input type="hidden" name="boton" value="Linea púrpura">
                    <button class="button" type="button" onclick="redirigirWhatsApp('3026032386', event)">
                        <span class="button2">Linea púrpura</span>
                    </button>
                </form>
            </div>
            <div class="description">
                (Línea de acompañamiento psicosocial y jurídico)
            </div>
        </div>

        <div class="button-group">
            <div class="icon-button-container">
                <div class="icon-container">
                    <img src="{% static 'img/sirena.png' %}" alt="Patrulla púrpura" class="icon" />
                </div>
                <form method="POST" id="form-Patrulla púrpura" class="form-boton">
                    {% csrf_token %}
                    <input type="hidden" name="boton" value="Patrulla púrpura">
                    <button class="button" type="button" onclick="redirigirWhatsApp('3156861972', event)">
                        <span class="button2">Patrulla púrpura</span>
                    </button>
                </form>
            </div>
            <div class="description">
                (Cuadrante de la Policía Nacional especializado en violencia basada en género.)
            </div>
        </div>

        <div class="button-group">
            <div class="icon-button-container">
                <div class="icon-container">
                    <img src="{% static 'img/taxi.png' %}" alt="Taxi púrpura" class="icon" />
                </div>
                <button class="button" type="button" onclick="abrirModal('Taxi púrpura')">
                    <span class="button2">Taxi púrpura</span>
                </button>
            </div>
            <div class="description">
                (Siéntete segura viajando en nuestros taxis<br>intermunicipales, especializados en transportar mujeres.)
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal-taxi" class="modal-overlay" style="display: none;">
        <div class="modal-taxi">
            <form method="POST" id="form-Linea púrpura" class="form-boton">
                {% csrf_token %}
                <h2>Selecciona una opción</h2>
                <input type="hidden" name="boton" value="Taxi púrpura">
                <button class="button" type="button" onclick="redirigirWhatsApp('3026032386', event)">Opción 1</button>
                <button class="button" type="button" onclick="redirigirWhatsApp('3026032386', event)">Opción 2</button>
                <button class="button" type="button" onclick="redirigirWhatsApp('3026032386', event)">Opción 3</button>
                <button class="button" type="button" onclick="redirigirWhatsApp('3026032386', event)">Opción 4</button>
                <button class="button" type="button" onclick="redirigirWhatsApp('3026032386', event)">Opción 5</button>
            </form>
            <button class="close-modal" onclick="cerrarModal()">Cerrar</button>
        </div>
    </div>
    

    <script>
        function abrirModal(nombreBoton) {
            const modal = document.getElementById('modal-taxi');
            modal.style.display = 'block';
            modal.setAttribute('data-nombre-boton', nombreBoton);
        }

        function cerrarModal() {
            const modal = document.getElementById('modal-taxi');
            modal.style.display = 'none';
            modal.removeAttribute('data-nombre-boton');
        }

    
        function redirigirWhatsApp(numero, event) {
            event.preventDefault(); // Prevenir el comportamiento predeterminado del botón (enviar el formulario)

            // Obtener el formulario correspondiente al botón
            const form = event.target.closest('form');
            const formData = new FormData(form);

            // Enviar el formulario usando AJAX
            fetch(form.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                }
            })
            .then(response => {
                if (response.ok) {
                    // Después de que el formulario se haya enviado correctamente, redirigir a WhatsApp
                    window.location.href = `https://wa.me/+57${numero}`;
                } else {
                    console.error('Error al enviar el formulario');
                }
            })
            .catch(error => {
                console.error('Error al enviar el formulario:', error);
            });
        }
    </script>

</body>

</html>
